<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cruise Ship Data - NauticalFlow</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link href="../styles.css" rel="stylesheet">
</head>

<body>
    <div id="loading-overlay" class="loading-overlay">
        <img src="../assets/img/loader-icon.svg" alt="Loading..." class="loader-icon">
    </div>

    <div id="navbar-placeholder"></div>
    <div class="d-flex">
        <div id="sidebar-placeholder"></div>
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4" id="main-content">
            <div
                class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="page-title"><i class="bi bi-send me-2"></i>Cruise Ship Management</h1>
            </div>

            <!-- NEW: Fuel Consumption Curve Chart -->
            <div class="card shadow mb-4" id="fuel-curve-card" style="display: none;">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <i class="bi bi-graph-up me-2"></i>
                        Fuel Consumption Curve: <span id="selected-ship-name">-</span>
                    </h6>
                    <button class="btn btn-sm btn-outline-secondary" id="close-curve-btn">
                        <i class="bi bi-x-circle me-1"></i>Close
                    </button>
                </div>
                <div class="card-body">
                    <canvas id="fuelCurveChart" style="max-height: 300px;"></canvas>
                    <div class="row mt-3 text-center">
                        <div class="col-md-3">
                            <div class="border rounded p-2">
                                <small class="text-muted">Gross Tonnage</small>
                                <h6 id="chart-gt">-</h6>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="border rounded p-2">
                                <small class="text-muted">Cruising Speed</small>
                                <h6 id="chart-cruise-speed">-</h6>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="border rounded p-2">
                                <small class="text-muted">At Cruise (22 kn)</small>
                                <h6 id="chart-cruise-consumption">-</h6>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="border rounded p-2">
                                <small class="text-muted">Hotel Load (0 kn)</small>
                                <h6 id="chart-hotel-load">-</h6>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- NEW: Academic Methodology Card -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">
                        <i class="bi bi-journal-text me-2"></i>
                        Fuel Consumption Calculation Methodology
                    </h6>
                </div>
                <div class="card-body">
                    <div class="alert alert-info mb-3">
                        <i class="bi bi-bookmark-star me-2"></i>
                        <strong>Academic Reference:</strong> Simonsen, M., Walnum, H.J., & Gössling, S. (2018). 
                        "Model for Estimation of Fuel Consumption of Cruise Ships" 
                        <em>Energies</em>, 11(5), 1059. 
                        <a href="https://doi.org/10.3390/en11051059" target="_blank" class="text-decoration-none">
                            https://doi.org/10.3390/en11051059
                        </a>
                    </div>
            
                    <div class="accordion" id="calculationAccordion">
                        
                        <!-- Overview Section -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#overviewSection" aria-expanded="true">
                                    <i class="bi bi-info-circle me-2"></i>
                                    <strong>Overview</strong>
                                </button>
                            </h2>
                            <div id="overviewSection" class="accordion-collapse collapse show"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <p>
                                        The fuel consumption curve is automatically calculated using a peer-reviewed academic methodology 
                                        from Simonsen et al. (2018). This approach uses <strong>actual installed power (MCR)</strong> 
                                        from ship specifications rather than estimation formulas, ensuring high accuracy.
                                    </p>
                                    <p class="mb-0">
                                        The <strong>cruise ship data</strong> can be obtained from 
                                        <a href="https://www.cruisemapper.com/ships" target="_blank">Cruise Mapper</a>.
                                    </p>
                                    <div class="alert alert-success mb-0 mt-3">
                                        <i class="bi bi-check-circle me-2"></i>
                                        <strong>Key Advantage:</strong> Uses speed-ratio method with load-dependent fuel consumption, 
                                        validated against real cruise ship operational data.
                                    </div>
                                </div>
                            </div>
                        </div>
            
                        <!-- Power Calculation Section -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#powerSection">
                                    <i class="bi bi-lightning me-2"></i>
                                    <strong>1. Power at Speed (Equation 12)</strong>
                                </button>
                            </h2>
                            <div id="powerSection" class="accordion-collapse collapse"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <h6 class="text-primary mb-3">Relative Power Calculation</h6>
                                    <div class="bg-light p-3 rounded mb-3">
                                        <code class="text-dark">
                                            P<sub>t</sub> = P<sub>ref</sub> × (V<sub>t</sub>/V<sub>ref</sub>)³ × τ<sub>w</sub> × τ<sub>f</sub>
                                        </code>
                                    </div>
            
                                    <table class="table table-sm table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Parameter</th>
                                                <th>Description</th>
                                                <th>Value</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>P<sub>ref</sub></strong></td>
                                                <td>Installed power (MCR)</td>
                                                <td>From ship specifications (MW)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>V<sub>t</sub>/V<sub>ref</sub></strong></td>
                                                <td>Speed ratio</td>
                                                <td>Actual speed / Service speed</td>
                                            </tr>
                                            <tr>
                                                <td><strong>τ<sub>w</sub></strong></td>
                                                <td>Weather factor</td>
                                                <td>1.15 (from paper)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>τ<sub>f</sub></strong></td>
                                                <td>Fouling factor</td>
                                                <td>1.09 (from paper)</td>
                                            </tr>
                                        </tbody>
                                    </table>
            
                                    <div class="alert alert-secondary mb-0">
                                        <strong>Note:</strong> This method uses actual MCR from ship specifications, 
                                        not estimated power from hull calculations. Power scales with the cube of speed (V³).
                                    </div>
                                </div>
                            </div>
                        </div>
            
                        <!-- Load Factor Section -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#loadSection">
                                    <i class="bi bi-speedometer me-2"></i>
                                    <strong>2. Load Factor (Equation 14)</strong>
                                </button>
                            </h2>
                            <div id="loadSection" class="accordion-collapse collapse"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <h6 class="text-primary mb-3">Engine Loading Calculation</h6>
                                    <div class="bg-light p-3 rounded mb-3">
                                        <code class="text-dark">
                                            L<sub>t</sub> = P<sub>t</sub> / P<sub>ref</sub>
                                        </code>
                                    </div>
            
                                    <p>
                                        The load factor represents how much of the engine's rated power is being used. 
                                        This is critical because fuel consumption per unit power changes with engine load.
                                    </p>
            
                                    <table class="table table-sm table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Load Factor</th>
                                                <th>Operating Condition</th>
                                                <th>Fuel Efficiency</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>&lt; 0.5</td>
                                                <td>Low load operation</td>
                                                <td>Lower efficiency</td>
                                            </tr>
                                            <tr>
                                                <td>0.6 - 0.8</td>
                                                <td>Optimal operating range</td>
                                                <td>Best efficiency</td>
                                            </tr>
                                            <tr>
                                                <td>0.8 - 1.0</td>
                                                <td>High load operation</td>
                                                <td>Good efficiency</td>
                                            </tr>
                                            <tr>
                                                <td>&gt; 1.0</td>
                                                <td>Exceeding MCR</td>
                                                <td>Reduced efficiency</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
            
                        <!-- SFC Section -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#sfcSection">
                                    <i class="bi bi-fuel-pump me-2"></i>
                                    <strong>3. Specific Fuel Consumption (Equation 17)</strong>
                                </button>
                            </h2>
                            <div id="sfcSection" class="accordion-collapse collapse"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <h6 class="text-primary mb-3">Load-Dependent SFC</h6>
                                    <div class="bg-light p-3 rounded mb-3">
                                        <code class="text-dark">
                                            SFC<sub>t</sub> = SFC<sub>base</sub> × [1.28 - 0.71×L<sub>t</sub> + 0.455×L<sub>t</sub>²]
                                        </code>
                                    </div>
            
                                    <table class="table table-sm table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Parameter</th>
                                                <th>Value</th>
                                                <th>Source</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><strong>SFC<sub>base</sub></strong></td>
                                                <td>195 g/kWh</td>
                                                <td>Table 1, Page 7 (post-2001 ships)</td>
                                            </tr>
                                            <tr>
                                                <td><strong>Load Factor (L<sub>t</sub>)</strong></td>
                                                <td>From Equation 14</td>
                                                <td>Calculated above</td>
                                            </tr>
                                        </tbody>
                                    </table>
            
                                    <div class="alert alert-warning mb-0">
                                        <i class="bi bi-exclamation-triangle me-2"></i>
                                        <strong>Critical:</strong> SFC changes with load! Engines are most efficient at 60-80% load. 
                                        This parabolic relationship is validated by real engine test data.
                                    </div>
                                </div>
                            </div>
                        </div>
            
                        <!-- Hotel Load Section -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#hotelSection">
                                    <i class="bi bi-building me-2"></i>
                                    <strong>4. Hotel Load (Auxiliary Power)</strong>
                                </button>
                            </h2>
                            <div id="hotelSection" class="accordion-collapse collapse"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <h6 class="text-primary mb-3">Non-Propulsion Power Requirements</h6>
            
                                    <p>
                                        Hotel load represents power consumed by all non-propulsion systems including 
                                        lighting, air conditioning, galleys, elevators, entertainment systems, and other onboard 
                                        facilities. This power is required even when the ship is stationary.
                                    </p>
            
                                    <table class="table table-sm table-bordered">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Ship Size (GT)</th>
                                                <th>Hotel Load Range</th>
                                                <th>Example Ships</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>&lt; 50,000</td>
                                                <td>3 - 5 MW</td>
                                                <td>Small expedition ships</td>
                                            </tr>
                                            <tr>
                                                <td>50,000 - 100,000</td>
                                                <td>5 - 10 MW</td>
                                                <td>Mid-size cruise ships</td>
                                            </tr>
                                            <tr>
                                                <td>100,000 - 200,000</td>
                                                <td>10 - 15 MW</td>
                                                <td>Large modern cruise ships</td>
                                            </tr>
                                            <tr>
                                                <td>&gt; 200,000</td>
                                                <td>15 - 25+ MW</td>
                                                <td>Mega ships (Oasis-class, Icon-class)</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
            
                        <!-- Final Calculation Section -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#finalSection">
                                    <i class="bi bi-calculator me-2"></i>
                                    <strong>5. Fuel Consumption (Equation 19)</strong>
                                </button>
                            </h2>
                            <div id="finalSection" class="accordion-collapse collapse"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <h6 class="text-primary mb-3">Final Fuel Calculation</h6>
                                    <div class="bg-light p-3 rounded mb-3">
                                        <code class="text-dark">
                                            Fuel (tons/hour) = Total Power (MW) × SFC<sub>t</sub> (g/kWh) / 1000
                                        </code>
                                    </div>
            
                                    <div class="alert alert-success">
                                        <h6 class="text-success"><i class="bi bi-check-circle me-2"></i>Validation</h6>
                                        <p class="mb-0">
                                            This methodology has been validated against real cruise ship data including 
                                            MS Finnmarken (15,690 GT), MS Artania (44,656 GT), and Norwegian Star (91,740 GT) 
                                            with accuracy within 5% of actual fuel consumption records.
                                        </p>
                                    </div>
            
                                    <div class="bg-light p-3 rounded">
                                        <strong>Total Power = Propulsion Power + Hotel Load</strong><br>
                                        <small class="text-muted">
                                            Note: The final formula does NOT divide by engine efficiency. 
                                            SFC values already represent actual fuel consumed per unit power.
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
            
                        <!-- Example Calculation -->
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#exampleSection">
                                    <i class="bi bi-clipboard-check me-2"></i>
                                    <strong>6. Example: Icon of the Seas at 22 knots</strong>
                                </button>
                            </h2>
                            <div id="exampleSection" class="accordion-collapse collapse"
                                data-bs-parent="#calculationAccordion">
                                <div class="accordion-body">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <h6 class="text-secondary">Given Specifications:</h6>
                                            <ul>
                                                <li>Gross Tonnage: 250,800 GT</li>
                                                <li>Installed Power (MCR): 84 MW</li>
                                                <li>Service Speed: 22 knots</li>
                                                <li>Hotel Load: ~17.5 MW</li>
                                            </ul>
                                        </div>
                                    </div>
            
                                    <div class="card mb-2">
                                        <div class="card-body py-2">
                                            <strong>Step 1:</strong> Propulsion Power<br>
                                            <code>P = 84 MW × (22/22)³ × 1.15 × 1.09 = 105.3 MW</code>
                                        </div>
                                    </div>
            
                                    <div class="card mb-2">
                                        <div class="card-body py-2">
                                            <strong>Step 2:</strong> Total Power<br>
                                            <code>Total = 105.3 + 17.5 = 122.8 MW</code>
                                        </div>
                                    </div>
            
                                    <div class="card mb-2">
                                        <div class="card-body py-2">
                                            <strong>Step 3:</strong> Load Factor<br>
                                            <code>L = 105.3 / 84 = 1.25</code>
                                        </div>
                                    </div>
            
                                    <div class="card mb-2">
                                        <div class="card-body py-2">
                                            <strong>Step 4:</strong> SFC Calculation<br>
                                            <code>SFC = 195 × [1.28 - 0.71×1.25 + 0.455×1.25²] = 215.5 g/kWh</code>
                                        </div>
                                    </div>
            
                                    <div class="card border-success">
                                        <div class="card-body py-2 bg-success bg-opacity-10">
                                            <strong>Step 5:</strong> Fuel Consumption<br>
                                            <code>Fuel = 122.8 × 215.5 / 1000 = <strong>26.5 tons/hour (635 tons/day)</strong></code>
                                        </div>
                                    </div>
            
                                    <div class="alert alert-info mb-0 mt-3">
                                        <i class="bi bi-info-circle me-2"></i>
                                        This matches industry expectations for mega cruise ships at cruising speed.
                                    </div>
                                </div>
                            </div>
                        </div>
            
                    </div>
                </div>
            </div>
            
            <!-- Cruise Ship Database Table -->
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <h6 class="m-0 font-weight-bold text-primary">Cruise Ship Database</h6>
                    <div class="d-flex gap-2">
                        <div style="position: relative;">
                            <input type="text" id="ship-search-input" class="form-control form-control-sm"
                                style="width: 300px; padding-left: 35px;">
                            <i class="bi bi-search"
                                style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); color: #6c757d;"></i>
                        </div>

                        <!-- NEW: CSV BUTTONS -->
                        <button class="btn btn-sm btn-outline-secondary" id="download-template-btn"
                            title="Download CSV Template">
                            <i class="bi bi-download me-1"></i>Download Template
                        </button>
                        <button class="btn btn-sm btn-outline-success" id="import-csv-btn"
                            title="Import Ships from CSV">
                            <i class="bi bi-upload me-1"></i>Import CSV
                        </button>
                        <input type="file" id="csv-file-input" accept=".csv" style="display: none;">

                        <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal"
                            data-bs-target="#shipModal">
                            <i class="bi bi-plus-circle me-1"></i>Add Cruise Ship
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover" id="vessel-data-table">
                            <thead>
                                <tr>
                                    <th>Ship Name</th>
                                    <th>Operator</th>
                                    <th>Gross Tonnage</th>
                                    <th>Propulsion Power</th>
                                    <th>Cruising Speed</th>
                                    <th>Max Speed</th>
                                    <th>Length</th>
                                    <th>Year Built</th>
                                    <th>Fuel Type</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
    </div>
    <!-- End of card -->

    <!-- THE COMPLETE MODAL STRUCTURE -->
    <div class="modal fade" id="shipModal" tabindex="-1">
        <div class="modal-dialog modal-lg"> <!-- Added modal-lg for wider modal -->
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="shipModalLabel">Add New Cruise Ship</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted small mb-3">
                        <i class="bi bi-info-circle me-1"></i>
                        Enter ship specifications from CruiseMapper. All critical fields are required for accurate fuel
                        consumption calculations.
                    </p>

                    <form id="shipForm" novalidate>
                        <input type="hidden" id="shipId">

                        <!-- Basic Information Section -->
                        <h6 class="text-primary mb-3"><i class="bi bi-ship me-2"></i>Basic Information</h6>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="shipName" class="form-label">Ship Name <span
                                        class="text-danger">*</span></label>
                                <input type="text" class="form-control" id="shipName" required>
                                <div class="invalid-feedback">Ship name is required.</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="operator" class="form-label">Operator / Company</label>
                                <input type="text" class="form-control" id="operator"
                                    placeholder="e.g., Royal Caribbean">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="builder" class="form-label">Builder</label>
                                <input type="text" class="form-control" id="builder" placeholder="e.g., Meyer Werft">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="yearBuilt" class="form-label">Year Built</label>
                                <input type="number" class="form-control" id="yearBuilt" placeholder="e.g., 2026"
                                    min="1900" max="2030">
                            </div>
                        </div>

                        <!-- Technical Specifications Section -->
                        <h6 class="text-primary mb-3 mt-4"><i class="bi bi-gear me-2"></i>Technical Specifications</h6>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="grossTonnage" class="form-label">Gross Tonnage (GT) <span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="grossTonnage" required min="1"
                                    placeholder="e.g., 250800">
                                <div class="invalid-feedback">Gross tonnage is required.</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="propulsionPower" class="form-label">Propulsion Power (MW) <span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="propulsionPower" required step="0.1"
                                    min="0" placeholder="e.g., 84">
                                <div class="invalid-feedback">Propulsion power is required.</div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="cruisingSpeed" class="form-label">Cruising Speed (knots) <span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="cruisingSpeed" required step="0.1" min="0"
                                    placeholder="e.g., 22">
                                <div class="invalid-feedback">Cruising speed is required.</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="maxSpeed" class="form-label">Max Speed (knots) <span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="maxSpeed" required step="0.1" min="0"
                                    placeholder="e.g., 25">
                                <div class="invalid-feedback">Max speed is required.</div>
                            </div>
                        </div>

                        <!-- Dimensions Section -->
                        <h6 class="text-primary mb-3 mt-4"><i class="bi bi-rulers me-2"></i>Dimensions</h6>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="length" class="form-label">Length (LOA in meters) <span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="length" required step="0.1" min="0"
                                    placeholder="e.g., 365">
                                <div class="invalid-feedback">Length is required.</div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="beam" class="form-label">Beam / Width (meters) <span
                                        class="text-danger">*</span></label>
                                <input type="number" class="form-control" id="beam" required step="0.1" min="0"
                                    placeholder="e.g., 65">
                                <div class="invalid-feedback">Beam is required.</div>
                            </div>
                        </div>

                        <!-- Capacity Section -->
                        <h6 class="text-primary mb-3 mt-4"><i class="bi bi-people me-2"></i>Capacity</h6>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="passengerCapacity" class="form-label">Passenger Capacity</label>
                                <input type="number" class="form-control" id="passengerCapacity" min="0"
                                    placeholder="e.g., 7600">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="crew" class="form-label">Crew Size</label>
                                <input type="number" class="form-control" id="crew" min="0" placeholder="e.g., 2350">
                            </div>
                        </div>

                        <!-- Propulsion & Fuel Section -->
                        <h6 class="text-primary mb-3 mt-4"><i class="bi bi-fuel-pump me-2"></i>Propulsion & Fuel</h6>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="engineType" class="form-label">Engine Type</label>
                                <input type="text" class="form-control" id="engineType"
                                    placeholder="e.g., Wartsila-LNG">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="fuelType" class="form-label">Primary Fuel Type <span
                                        class="text-danger">*</span></label>
                                <select class="form-select" id="fuelType" required>
                                    <option value="" disabled selected>Select a Fuel Type</option>
                                </select>
                                <div class="invalid-feedback">Fuel type is required.</div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="submit" form="shipForm" class="btn btn-primary">Save Cruise Ship</button>
                </div>
            </div>
        </div>
    </div>
    <!-- End of modal -->

    <!-- CSV Import Results Modal -->
    <div class="modal fade" id="csvImportModal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="bi bi-file-earmark-spreadsheet me-2"></i>
                        CSV Import Review
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Progress Bar (shown during import) -->
                    <div id="import-progress-container" style="display: none;">
                        <h6 class="mb-3">Importing Ships...</h6>
                        <div class="progress mb-3" style="height: 25px;">
                            <div id="import-progress-bar"
                                class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar"
                                style="width: 0%">0%</div>
                        </div>
                        <p class="text-muted small" id="import-progress-text">Processing...</p>
                    </div>

                    <!-- Validation Errors (if any) -->
                    <div id="validation-errors-container" style="display: none;">
                        <div class="alert alert-danger">
                            <h6><i class="bi bi-exclamation-triangle me-2"></i>Validation Errors</h6>
                            <p class="mb-2">The following rows have errors and cannot be imported:</p>
                            <div id="validation-errors-list"></div>
                        </div>
                    </div>

                    <!-- Duplicate Ships (if any) -->
                    <div id="duplicate-ships-container" style="display: none;">
                        <div class="alert alert-warning">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="mb-0"><i class="bi bi-exclamation-circle me-2"></i>Duplicate Ships Found</h6>
                                <div>
                                    <button type="button" class="btn btn-sm btn-outline-secondary"
                                        id="select-all-duplicates">
                                        <i class="bi bi-check-square me-1"></i>Select All
                                    </button>
                                    <button type="button" class="btn btn-sm btn-outline-secondary"
                                        id="deselect-all-duplicates">
                                        <i class="bi bi-square me-1"></i>Deselect All
                                    </button>
                                </div>
                            </div>
                            <p class="mb-2">The following ships already exist. Check the boxes to update them:</p>
                            <div id="duplicate-ships-list"></div>
                        </div>
                    </div>

                    <!-- Valid Ships Ready to Import -->
                    <div id="valid-ships-container" style="display: none;">
                        <div class="alert alert-success">
                            <h6><i class="bi bi-check-circle me-2"></i>Ready to Import</h6>
                            <p class="mb-0"><span id="valid-ships-count">0</span> ship(s) will be added to the database.
                            </p>
                        </div>
                    </div>

                    <!-- Summary after import -->
                    <div id="import-summary-container" style="display: none;">
                        <div class="row text-center">
                            <div class="col-md-4">
                                <div class="card border-success">
                                    <div class="card-body">
                                        <h3 class="text-success" id="summary-imported">0</h3>
                                        <p class="mb-0">Imported</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-warning">
                                    <div class="card-body">
                                        <h3 class="text-warning" id="summary-updated">0</h3>
                                        <p class="mb-0">Updated</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card border-secondary">
                                    <div class="card-body">
                                        <h3 class="text-secondary" id="summary-skipped">0</h3>
                                        <p class="mb-0">Skipped</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer" id="import-modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="confirm-import-btn">
                        <i class="bi bi-upload me-1"></i>Confirm Import
                    </button>
                </div>
            </div>
        </div>
    </div>

    </main>
    </div>
    </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script type="module" src="js/vessel-data.js"></script>
    <script src="https://cdn.botpress.cloud/webchat/v3.3/inject.js"></script>
    <script src="https://files.bpcontent.cloud/2025/11/02/10/20251102105058-M6B4IKVL.js" defer></script>
</body>

</html>